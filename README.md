# Neural Translation of Input Specifications into Formal Grammars for Test Case Generation

by Anonymous

This repo provides the source code & data of our work.

## Abstract

> Test cases are crucial for ensuring the program's correctness and evaluating
> performance in programming. The high diversity of test cases within
> constraints is necessary to distinguish between correct and incorrect
> answers. Automated source code generation is currently a popular area due to
> the inefficiency of manually generating test cases. Recent attempts involve
> generating conditional cases from problem descriptions using deep-learning
> models that learn from source code. However, this task requires a combination
> of complex skills such as extracting syntactic and logical constraints for a
> given test case from a problem, and generating test cases that satisfy the
> constraints. In this work, we introduce a modified context-free grammar that
> explicitly represents the syntactical and logical constraints embedded within
> programming problems. Our innovative framework for automated test case
> generation separates restriction extraction from test case generation,
> simplifying the task for the model. We compare diverse methods for neural
> translation of input specifications into formal grammars.

## Usage

```bash
$ python3 -m venv .venv
$ source .venv/bin/activate
$ source .envrc
```

## Data download

```bash
$ python scripts/download_dataset.py
$ python scripts/filter_python_dataset.py
$ python scripts/filter_labeled_test_dataset.py
$ python scripts/generate_python3_solutions.py
```

### Reproducing grammars generated by the CcfgT5 model

```bash
$ python train.py -h
usage: train.py [-h] [--loss-path LOSS_PATH] [--config CONFIG]

optional arguments:
  -h, --help            show this help message and exit
  --loss-path LOSS_PATH
  --config CONFIG
```

### Reproducing the evaluation results

Place solution files in `data/solutions/{solutions,incorrect_solutions}/`.
Then, `make all` command will reproduce the following evaluation results.

```bash
 data
 ├── execution-summary
 │   ├── code-contest/{generated,private,public}/test.jsonl
 │   ├── direct/{gemini,gpt}/test.jsonl
 │   ├── fuzzing/{private,public}/test.jsonl
 │   └── grammar
 │       ├── ccfg-t5/{beam-1,beam-10}/test.jsonl
 │       ├── gemini/{1-shot,5-shot}/test.jsonl
 │       ├── gpt/{1-shot,5-shot}/test.jsonl
 │       └── ground-truth/test.jsonl
 ├── generation-result
 │   ├── code-contest/{generated,private,public}/test.jsonl
 │   ├── direct/{gemini,gpt}/test.jsonl
 │   ├── fuzzing/{private,public}/test.jsonl
 │   └── grammar
 │       ├── ccfg-t5/{beam-1,beam-10}/test.jsonl
 │       ├── gemini/{1-shot,5-shot}/test.jsonl
 │       ├── gpt/{1-shot,5-shot}/test.jsonl
 │       └── ground-truth/test.jsonl
 └── parsing-result
        ├── ccfg-t5/{beam-1,beam-10}/test.jsonl
        ├── gemini/{1-shot,5-shot}/test.jsonl
        ├── gpt/{1-shot,5-shot}/test.jsonl
        └── ground-truth/test.jsonl
```

To see the analysis, run the following commands.

```bash
bash scripts/print/{validity,effectiveness}.sh
bash scripts/print/{validity,effectiveness}_level.sh
bash scripts/print/effectiveness_length{,_acc,_comb}.sh
bash scripts/print/{exact_match,bleu_score}.sh
bash scripts/print/generality.sh
```

## Citation

Not available.

## License

All source code is made available under a BSD 3-clause license. You can freely
use and modify the code, without warranty, so long as you provide attribution
to the authors. See `LICENSE.md` for the full license text.
